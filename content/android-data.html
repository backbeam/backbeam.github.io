<!DOCTYPE HTML>
<html lang="en-US" manifest="./manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Manipulating data | Backbeam documentation</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="backbeam">
        <meta name="description" content="Welcome to the Backbeam *documentation*.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="./android-authentication.html" />
        
        
        <link rel="prev" href="./android-objects.html" />
        

        <meta property="og:title" content="Manipulating data | Backbeam documentation">
        <meta property="og:site_name" content="Backbeam documentation">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/backbeam">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="gitbook/style.css">
        


        
    <div class="book" data-github="backbeam/backbeam.github.io" data-level="3.2" data-basepath="." data-revision="1399664047867">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://backbeam.io/documentation" target="_blank" class="btn pull-left"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    
    
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/backbeam/backbeam.github.io/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/backbeam/backbeam.github.io/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="./" >Backbeam documentation</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        

        

        
        <li>
            <a href="https://github.com/backbeam/backbeam.github.io/edit/master/android-data.md" target="blank">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="./"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="overview.html">
                
                <a href="./overview.html">
                    <i class="fa fa-check"></i> <b>1.</b> Overview
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="1.1" data-path="overview-features.html">
                            
                            <a href="./overview-features.html">
                                <i class="fa fa-check"></i> <b>1.1.</b> Features
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.2" data-path="overview-query-language.html">
                            
                            <a href="./overview-query-language.html">
                                <i class="fa fa-check"></i> <b>1.2.</b> Query language
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.3" data-path="overview-control-panel.html">
                            
                            <a href="./overview-control-panel.html">
                                <i class="fa fa-check"></i> <b>1.3.</b> Control panel
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.4" data-path="overview-business-logic.html">
                            
                            <a href="./overview-business-logic.html">
                                <i class="fa fa-check"></i> <b>1.4.</b> Where to write the business logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.5" data-path="overview-authentication.html">
                            
                            <a href="./overview-authentication.html">
                                <i class="fa fa-check"></i> <b>1.5.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.6" data-path="overview-push-notifications.html">
                            
                            <a href="./overview-push-notifications.html">
                                <i class="fa fa-check"></i> <b>1.6.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.7" data-path="overview-email-delivery.html">
                            
                            <a href="./overview-email-delivery.html">
                                <i class="fa fa-check"></i> <b>1.7.</b> Email templates and delivery
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.8" data-path="overview-realtime.html">
                            
                            <a href="./overview-realtime.html">
                                <i class="fa fa-check"></i> <b>1.8.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="2" data-path="ios-sdk.html">
                
                <a href="./ios-sdk.html">
                    <i class="fa fa-check"></i> <b>2.</b> iOS SDK
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="ios-objects.html">
                            
                            <a href="./ios-objects.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Objects and query results
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="ios-data.html">
                            
                            <a href="./ios-data.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Manipulating data
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="ios-authentication.html">
                            
                            <a href="./ios-authentication.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.4" data-path="ios-server-side-logic.html">
                            
                            <a href="./ios-server-side-logic.html">
                                <i class="fa fa-check"></i> <b>2.4.</b> Server side logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.5" data-path="ios-push-notifications.html">
                            
                            <a href="./ios-push-notifications.html">
                                <i class="fa fa-check"></i> <b>2.5.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.6" data-path="ios-realtime.html">
                            
                            <a href="./ios-realtime.html">
                                <i class="fa fa-check"></i> <b>2.6.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="3" data-path="android-sdk.html">
                
                <a href="./android-sdk.html">
                    <i class="fa fa-check"></i> <b>3.</b> Android SDK
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="android-objects.html">
                            
                            <a href="./android-objects.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> Objects and query results
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="android-data.html">
                            
                            <a href="./android-data.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Manipulating data
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="android-authentication.html">
                            
                            <a href="./android-authentication.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.4" data-path="android-server-side-logic.html">
                            
                            <a href="./android-server-side-logic.html">
                                <i class="fa fa-check"></i> <b>3.4.</b> Server side logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.5" data-path="android-push-notifications.html">
                            
                            <a href="./android-push-notifications.html">
                                <i class="fa fa-check"></i> <b>3.5.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.6" data-path="android-realtime.html">
                            
                            <a href="./android-realtime.html">
                                <i class="fa fa-check"></i> <b>3.6.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="4" data-path="javascript-sdk.html">
                
                <a href="./javascript-sdk.html">
                    <i class="fa fa-check"></i> <b>4.</b> JavaScript SDK
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="4.1" data-path="javascript-data.html">
                            
                            <a href="./javascript-data.html">
                                <i class="fa fa-check"></i> <b>4.1.</b> Manipulating data
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.2" data-path="javascript-authentication.html">
                            
                            <a href="./javascript-authentication.html">
                                <i class="fa fa-check"></i> <b>4.2.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.3" data-path="javascript-server-side-logic.html">
                            
                            <a href="./javascript-server-side-logic.html">
                                <i class="fa fa-check"></i> <b>4.3.</b> Server side logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.4" data-path="javascript-push-notifications.html">
                            
                            <a href="./javascript-push-notifications.html">
                                <i class="fa fa-check"></i> <b>4.4.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.5" data-path="javascript-realtime.html">
                            
                            <a href="./javascript-realtime.html">
                                <i class="fa fa-check"></i> <b>4.5.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="5" data-path="web-development.html">
                
                <a href="./web-development.html">
                    <i class="fa fa-check"></i> <b>5.</b> Web development
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="5.1" data-path="web-development-versioning.html">
                            
                            <a href="./web-development-versioning.html">
                                <i class="fa fa-check"></i> <b>5.1.</b> Versioning
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.2" data-path="web-development-controllers.html">
                            
                            <a href="./web-development-controllers.html">
                                <i class="fa fa-check"></i> <b>5.2.</b> Controllers
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.3" data-path="web-development-domains.html">
                            
                            <a href="./web-development-domains.html">
                                <i class="fa fa-check"></i> <b>5.3.</b> Subdomains and custom domain
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.4" data-path="web-development-views.html">
                            
                            <a href="./web-development-views.html">
                                <i class="fa fa-check"></i> <b>5.4.</b> Views (templates)
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.5" data-path="web-development-assets.html">
                            
                            <a href="./web-development-assets.html">
                                <i class="fa fa-check"></i> <b>5.5.</b> Assets
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="6" data-path="rest-api.html">
                
                <a href="./rest-api.html">
                    <i class="fa fa-check"></i> <b>6.</b> REST API
                </a>
                
                
            </li>
        

        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 52.77777777777778%;min-width: 50%;"></div>
    </div>
    <div class="chapters">
    
        <a href="./index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="./overview.html" title="Overview" class="chapter done new-chapter" data-progress="1" style="left: 2.7777777777777777%;"></a>
    
        <a href="./overview-features.html" title="Features" class="chapter done " data-progress="1.1" style="left: 5.555555555555555%;"></a>
    
        <a href="./overview-query-language.html" title="Query language" class="chapter done " data-progress="1.2" style="left: 8.333333333333334%;"></a>
    
        <a href="./overview-control-panel.html" title="Control panel" class="chapter done " data-progress="1.3" style="left: 11.11111111111111%;"></a>
    
        <a href="./overview-business-logic.html" title="Where to write the business logic" class="chapter done " data-progress="1.4" style="left: 13.88888888888889%;"></a>
    
        <a href="./overview-authentication.html" title="Users authentication" class="chapter done " data-progress="1.5" style="left: 16.666666666666668%;"></a>
    
        <a href="./overview-push-notifications.html" title="Push notifications" class="chapter done " data-progress="1.6" style="left: 19.444444444444443%;"></a>
    
        <a href="./overview-email-delivery.html" title="Email templates and delivery" class="chapter done " data-progress="1.7" style="left: 22.22222222222222%;"></a>
    
        <a href="./overview-realtime.html" title="Realtime" class="chapter done " data-progress="1.8" style="left: 25%;"></a>
    
        <a href="./ios-sdk.html" title="iOS SDK" class="chapter done new-chapter" data-progress="2" style="left: 27.77777777777778%;"></a>
    
        <a href="./ios-objects.html" title="Objects and query results" class="chapter done " data-progress="2.1" style="left: 30.555555555555557%;"></a>
    
        <a href="./ios-data.html" title="Manipulating data" class="chapter done " data-progress="2.2" style="left: 33.333333333333336%;"></a>
    
        <a href="./ios-authentication.html" title="Users authentication" class="chapter done " data-progress="2.3" style="left: 36.111111111111114%;"></a>
    
        <a href="./ios-server-side-logic.html" title="Server side logic" class="chapter done " data-progress="2.4" style="left: 38.888888888888886%;"></a>
    
        <a href="./ios-push-notifications.html" title="Push notifications" class="chapter done " data-progress="2.5" style="left: 41.666666666666664%;"></a>
    
        <a href="./ios-realtime.html" title="Realtime" class="chapter done " data-progress="2.6" style="left: 44.44444444444444%;"></a>
    
        <a href="./android-sdk.html" title="Android SDK" class="chapter done new-chapter" data-progress="3" style="left: 47.22222222222222%;"></a>
    
        <a href="./android-objects.html" title="Objects and query results" class="chapter done " data-progress="3.1" style="left: 50%;"></a>
    
        <a href="./android-data.html" title="Manipulating data" class="chapter done " data-progress="3.2" style="left: 52.77777777777778%;"></a>
    
        <a href="./android-authentication.html" title="Users authentication" class="chapter  " data-progress="3.3" style="left: 55.55555555555556%;"></a>
    
        <a href="./android-server-side-logic.html" title="Server side logic" class="chapter  " data-progress="3.4" style="left: 58.333333333333336%;"></a>
    
        <a href="./android-push-notifications.html" title="Push notifications" class="chapter  " data-progress="3.5" style="left: 61.111111111111114%;"></a>
    
        <a href="./android-realtime.html" title="Realtime" class="chapter  " data-progress="3.6" style="left: 63.888888888888886%;"></a>
    
        <a href="./javascript-sdk.html" title="JavaScript SDK" class="chapter  new-chapter" data-progress="4" style="left: 66.66666666666667%;"></a>
    
        <a href="./javascript-data.html" title="Manipulating data" class="chapter  " data-progress="4.1" style="left: 69.44444444444444%;"></a>
    
        <a href="./javascript-authentication.html" title="Users authentication" class="chapter  " data-progress="4.2" style="left: 72.22222222222223%;"></a>
    
        <a href="./javascript-server-side-logic.html" title="Server side logic" class="chapter  " data-progress="4.3" style="left: 75%;"></a>
    
        <a href="./javascript-push-notifications.html" title="Push notifications" class="chapter  " data-progress="4.4" style="left: 77.77777777777777%;"></a>
    
        <a href="./javascript-realtime.html" title="Realtime" class="chapter  " data-progress="4.5" style="left: 80.55555555555556%;"></a>
    
        <a href="./web-development.html" title="Web development" class="chapter  new-chapter" data-progress="5" style="left: 83.33333333333333%;"></a>
    
        <a href="./web-development-versioning.html" title="Versioning" class="chapter  " data-progress="5.1" style="left: 86.11111111111111%;"></a>
    
        <a href="./web-development-controllers.html" title="Controllers" class="chapter  " data-progress="5.2" style="left: 88.88888888888889%;"></a>
    
        <a href="./web-development-domains.html" title="Subdomains and custom domain" class="chapter  " data-progress="5.3" style="left: 91.66666666666667%;"></a>
    
        <a href="./web-development-views.html" title="Views (templates)" class="chapter  " data-progress="5.4" style="left: 94.44444444444444%;"></a>
    
        <a href="./web-development-assets.html" title="Assets" class="chapter  " data-progress="5.5" style="left: 97.22222222222223%;"></a>
    
        <a href="./rest-api.html" title="REST API" class="chapter  new-chapter" data-progress="6" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_3">
                    
                        <h1 id="manipulating-data">Manipulating data</h1>
<p>This documentation is about manipulating data from your Android code. This requires you to create a pair of API keys and configure them in your main activity. If you want to user server-side logic you should go to the <a href="android-server-side-logic.html">Server-side logic</a> section of the documentation.</p>
<h2 id="making-queries">Making queries</h2>
<p>You make queries using <code>Query</code> objects. You create them using the <code>Backbeam.select()</code> method passing the entity identifier. It is optional to set a BQL query using <code>setQuery()</code>. Then you fetch the results calling <code>fetch()</code> with three arguments:</p>
<ul>
<li><code>limit</code> The maximum number of elements to fetch</li>
<li><code>offset</code> The offset of the query</li>
<li><code>callback</code> The callback handler to handle the query result</li>
</ul>
<p>The <code>setQuery()</code> method receives a Stirng containing a BQL query. If the BQL query needs parameters you pass them to the method just separating them with commas.</p>
<pre><code class="lang-java">q.setQuery(<span class="hljs-string">"where name like ? and score &gt; ?"</span>, <span class="hljs-string">"awesome"</span>, <span class="hljs-number">100</span>);
</code></pre>
<p>All operations that need to send or receive information fromt the server are handled asynchronously. If the operation receives information you provide a callback. Since Java doesn&#39;t support closures yet, you normally will pass an object of an anonymous class created inline. These callbacks usually have a <code>success()</code> method that you must implement and optionally you can override a <code>failure()</code> method.</p>
<pre><code class="lang-java">Backbeam.select(<span class="hljs-string">"place"</span>).setQuery(<span class="hljs-string">"sort by created_at"</span>).fetch(<span class="hljs-number">100</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> FetchCallback() {
  <span class="hljs-annotation">@Override</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(List&lt;BackbeamObject&gt; objects, <span class="hljs-keyword">int</span> totalCount, <span class="hljs-keyword">boolean</span> fromCache) {
    <span class="hljs-keyword">for</span> (BackbeamObject object : objects) {
      <span class="hljs-comment">// Do something with this object</span>
      System.out.println(<span class="hljs-string">"object "</span>+object.getString(<span class="hljs-string">"name"</span>));
    }
  }
});
</code></pre>
<p>In this case the <code>success()</code> method receives three arguments</p>
<ul>
<li>objects The list of objects returned by the query</li>
<li>totalCount The total number of objects that this query could return</li>
<li>fromCache Indicates whether the result was fetched from the cache or not</li>
</ul>
<p>Queries can be cached in different ways. Before fetching the result of a query you can set the query fetch policy calling the <code>setFetchPolicy()</code> method. There are a few fetch policies available:</p>
<ul>
<li>REMOTE_ONLY This is the default policy. The cache is ignored and the operation is performed against the server</li>
<li>LOCAL_ONLY The result is fetched from cache if available. If not available the failure() method is called</li>
<li>LOCAL_AND_REMOTE The result is fetched from cache if available. Then the query fetches the result from the server. So in this case the method success() might be called twice.</li>
<li>LOCAL_OR_REMOTE The result is fetched from cache if available. If not available the result is fetched from the server.</li>
</ul>
<p>No matter what policy you use either <code>success()</code> or <code>failure()</code> are guaranteed to be called at least once.</p>
<h2 id="removing-objects-matching-a-query">Removing objects matching a query</h2>
<p>If you need to remove several objects at once and they share common constraints you can create a query and then call one of these methods... You can remove a limited number of objects:</p>
<pre><code class="lang-java">Query query = Backbeam.select(<span class="hljs-string">"some-entity"</span>).setQuery(...);
query.remove(<span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> RemoveCallback() {

  <span class="hljs-annotation">@Override</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(<span class="hljs-keyword">int</span> removed) {
    <span class="hljs-comment">// Here the first 10 objects matching the query have been removed</span>
  }

});
</code></pre>
<p>Or you can remove all objects matching the query</p>
<pre><code class="lang-java">Query query = Backbeam.select(<span class="hljs-string">"some-entity"</span>).setQuery(...);
query.removeAll(<span class="hljs-keyword">new</span> RemoveCallback() {

  <span class="hljs-annotation">@Override</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(<span class="hljs-keyword">int</span> removed) {
    <span class="hljs-comment">// Here the objects have been removed. You can get the number of removed objects</span>
  }

});
`
</code></pre>
<h2 id="collection-constraints">Collection constraints</h2>
<p>There is a helper object to create collection constraints when using the in operator in a query.</p>
<pre><code class="lang-java">CollectionConstraint collection = <span class="hljs-keyword">new</span> CollectionConstraint();
collection.addTwitterIdentifier(someTwitterIdentifier);
collection.addObject(<span class="hljs-keyword">new</span> BackbeamObject(<span class="hljs-string">"user"</span>, someBackbeamIdentifier));
collection.addEmailAddress(<span class="hljs-string">"user@example.com"</span>);

Query query = <span class="hljs-keyword">new</span> Query(<span class="hljs-string">"user"</span>);
query.setQuery(<span class="hljs-string">"where this in ?"</span>, collection);
query.fetch(<span class="hljs-number">100</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> FetchCallback() {

  <span class="hljs-annotation">@Override</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(List objects, <span class="hljs-keyword">int</span> totalCount,
      <span class="hljs-keyword">boolean</span> fromCache) {

    System.out.println(<span class="hljs-string">"objects: "</span>+objects.size());
  }
});
</code></pre>
<p>As you can see in the collection constraint you can use Backbeam objects. This applies to any entity in your data model. If you are querying users you can also use Twitter, Facebook, Google+, LinkedIn or Twitter identifiers as well as email addresses.</p>
<h2 id="creating-or-updating-objects">Creating or updating objects</h2>
<p>To create or update objects you use the save()method. To create a new object first you need to instantiate an empty object passing the entity name to which this object will be a member of.</p>
<pre><code class="lang-java">BackbeamObject obj = <span class="hljs-keyword">new</span> BackbeamObject(<span class="hljs-string">"place"</span>);
obj.setString(<span class="hljs-string">"name"</span>, <span class="hljs-string">"A new place"</span>);
obj.save(<span class="hljs-keyword">new</span> ObjectCallback() {
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(BackbeamObject object) {
        System.out.println(<span class="hljs-string">"created! :) "</span>+object.getId());
    }
});
</code></pre>
<ul>
<li><code>setString(String fieldName, String value)</code> Sets the value of a text field</li>
<li><code>setDate(String fieldName, Date value)</code> Sets the value of a date field</li>
<li><code>setNumber(String fieldName, Number value)</code> Sets the value of a numeric field</li>
<li><code>incrementNumber(String fieldName, int value)</code> Increments the value of a numeric field</li>
<li><code>setLocation(String fieldName, Location value)</code> Sets the value of a &quot;location&quot; field</li>
<li><code>setBoolean(String fieldName, boolean value)</code> Sets the value of a boolean field</li>
<li><code>setDay(String fieldName, GregorianCalendar value)</code> Sets the value of a &quot;day&quot; field. You can pass a Gregorian calendar. You can also pass a java.util.Date and the current calendar&#39;s timezone will be used to calculate the year, month and day.</li>
<li><code>setObject(String fieldName, BackbeamObject value)</code> Sets the value of a relationship &quot;to-one&quot;</li>
</ul>
<p>If you want to update an object of which you know the identifier but you don&#39;t have an instance of it you can pass the identifier to the <code>BackbeamObject</code> constructor</p>
<p>When an object is created or updated the server saves the changes you made and sends you any other change that could been made to that object. So inside the <code>success()</code> method the object is fully synchronized.</p>
<pre><code class="lang-java">BackbeamObject obj = <span class="hljs-keyword">new</span> BackbeamObject(<span class="hljs-string">"place"</span>, identifierYourAlreadyKnow);
obj.setString(<span class="hljs-string">"name"</span>, <span class="hljs-string">"A new name for that palce"</span>);
obj.save(<span class="hljs-keyword">new</span> ObjectCallback() {
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(BackbeamObject object) {
        <span class="hljs-comment">// here you can access any field of 'object'</span>
    }
});
</code></pre>
<p>To add or remove objects of a relationship &quot;to-many&quot; you will use the methods <code>removeObject(String fieldName, BackbeamObject object)</code> and <code>addObject(String fieldName, BackbeamObject object)</code>. For example:</p>
<pre><code class="lang-java">BackbeamObject user = ...;
user.addObject(<span class="hljs-string">"friends"</span>, myNewFriend);
user.removeObject(<span class="hljs-string">"friends"</span>, userThatIsNoLongerMyFriend);
user.save(<span class="hljs-keyword">new</span> ObjectCallback() {
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(BackbeamObject object) {
        <span class="hljs-comment">// ...</span>
    }
});
</code></pre>
<h2 id="reading-and-refreshing-objects">Reading and refreshing objects</h2>
<p>If you have an object instance and you need to fill it with the latest changes on the server without making you new changes then you use the refresh() method.</p>
<pre><code class="lang-java">BackbeamObject obj = someObjectYouAlreadyHaveInstantiated;
obj.refresh(<span class="hljs-keyword">new</span> ObjectCallback() {
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(BackbeamObject object) {
        <span class="hljs-comment">// here you can access any field of 'object'</span>
    }
});
</code></pre>
<p>The <code>refresh()</code> method is overloaded and accepts an optional first parameter that is part of a BQL query. In this parameter you can specify to join some relationships while synchronizating the state of this object.</p>
<pre><code class="lang-java">BackbeamObject obj = someObjectYouAlreadyHaveInstantiated;
obj.refresh(<span class="hljs-string">"join some-relationship"</span>, <span class="hljs-keyword">new</span> ObjectCallback() {
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(BackbeamObject object) {
        <span class="hljs-comment">// here you can access any field. You can also access the joined relationship</span>
        JoinResult result = object.getJoinResult(<span class="hljs-string">"some-relationship"</span>)
    }
});
</code></pre>
<p>If you need to read an object of which you know its identifier and you don&#39;t already instantiated it then you can use <code>Backbeam.read()</code>.</p>
<pre><code class="lang-java">Backbeam.read(<span class="hljs-string">"place"</span>, id, <span class="hljs-keyword">new</span> ObjectCallback() {
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(BackbeamObject object) {
        <span class="hljs-comment">// ...</span>
    }
});
</code></pre>
<p>The first argument is the entity identifier, the second is the unique identifier of that object and finally you pass the callback that will be called when the operation is complete. You can optionally pass a parameter that is part of a BQL query to join some relationships.</p>
<h2 id="working-with-files">Working with files</h2>
<p>There is a special kind of entity that lets you hold files. It is the File entity. The entity itself holds information about the type of file, size, etc. If you need the download the content of the file you need to generate a URL. There is a special method called <code>composeFileURL</code> to which you can pass parameters. For example if you want to download an image you can transform it indicating a width and/or height. You can also pass <code>null</code> to this method.</p>
<pre><code class="lang-java">TreeMap&lt;String, Object&gt; options = <span class="hljs-keyword">new</span> TreeMap&lt;String, Object&gt;();
options.put(<span class="hljs-string">"width"</span>, <span class="hljs-number">40</span>);
options.put(<span class="hljs-string">"height"</span>, <span class="hljs-number">40</span>);
String url = fileObject.composeFileURL(options);
`
</code></pre>
<p>Note that the file object should have their properties loaded. Specially <code>File</code> objects have a <code>version</code> field that is required to generate the URL. This field changes everytime the file content changes. This way the URL changes everytime the content changes and there are no problems with any cache. In summary, be sure that the file has its version field loaded. You can&#39;t do a refresh if it is not loaded. And if the file object is the result of a query be sure to use a join on the relationship. See this example:</p>
<pre><code class="lang-java">Backbeam.select(<span class="hljs-string">"company"</span>).setQuery(<span class="hljs-string">"join logo"</span>).fetch(<span class="hljs-number">100</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> FetchCallback() {
  <span class="hljs-annotation">@Override</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(List&lt;BackbeamObject&gt; companies, <span class="hljs-keyword">int</span> totalCount, <span class="hljs-keyword">boolean</span> fromCache) {
    <span class="hljs-keyword">for</span> (BackbeamObject company : companies) {
      BackbeamObject logo = company.getObject(<span class="hljs-string">"logo"</span>);
      String logoURL = logo.composeFileURL(<span class="hljs-keyword">null</span>);
      <span class="hljs-comment">// Do something with logoURL</span>
    }
  }
});
</code></pre>
<p>For images it is recommended to use an external library such as <a href="https://github.com/nostra13/Android-Universal-Image-Loader" target="_blank">Android Universal Image Loader</a> to handle images efficiently.</p>
<h2 id="geoqueries">Geoqueries</h2>
<p>You can perform geoqueries on entities having at least one field whose type is set to location. There are two types of geolocated queries: you can query the closest objects to a given point or you can query the objects inside a bounding box.</p>
<h3 id="fetching-the-closest-objects-to-a-location">Fetching the closest objects to a location</h3>
<p>To query objects near to a given location you need to tell the SDK the name of the field whose type is location, the coordinates of the point (latitude + longitude), and the maximum number of results you want to fetch. The success block is very similar to a regular success query block but it returns additionally the distances of the objects to the location used to query the data. The distances are measured in meters.</p>
<pre><code class="lang-java">Query query = <span class="hljs-keyword">new</span> Query(<span class="hljs-string">"place"</span>);
query.near(<span class="hljs-string">"location"</span>, <span class="hljs-number">41.641113</span>, -<span class="hljs-number">0.895115</span>, <span class="hljs-number">10</span>, <span class="hljs-keyword">new</span> NearFetchCallback() {

  <span class="hljs-annotation">@Override</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(List&lt;BackbeamObject&gt; objects, <span class="hljs-keyword">int</span> totalCount,
      List&lt;Integer&gt; distances, <span class="hljs-keyword">boolean</span> fromCache) {

    <span class="hljs-comment">// Success</span>

  }
});
</code></pre>
<h3 id="fetching-objects-in-a-bounding-box">Fetching objects in a bounding box</h3>
<p>To query objects inside a bounding box you need to tell the SDK the name of the field whose type is location, the south-west and north-east coordinates of the corners of the bounding box, and the maximum number of results you want to fetch. The success block is exactly the same to any regular success query block.</p>
<pre><code class="lang-java">Query query = <span class="hljs-keyword">new</span> Query(<span class="hljs-string">"place"</span>);
query.bounding(<span class="hljs-string">"location"</span>, <span class="hljs-number">41.641113</span>, -<span class="hljs-number">0.902896</span>, <span class="hljs-number">41.645883</span>, -<span class="hljs-number">0.895115</span>, <span class="hljs-number">10</span>, <span class="hljs-keyword">new</span> FetchCallback() {

  <span class="hljs-annotation">@Override</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">success</span>(List&lt;BackbeamObject&gt; objects, <span class="hljs-keyword">int</span> totalCount,
      <span class="hljs-keyword">boolean</span> fromCache) {

    <span class="hljs-comment">// Success</span>

  }
});
</code></pre>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="./android-objects.html" class="navigation navigation-prev "><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./android-authentication.html" class="navigation navigation-next "><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="gitbook/app.js"></script>
        

    
    <script src="gitbook/plugins/gitbook-plugin-disqus/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":"sepia","family":"serif","size":1},"disqus":{"shortName":"backbeamdocs"}};
    gitbook.start(config);
});
</script>

    </body>
</html>
