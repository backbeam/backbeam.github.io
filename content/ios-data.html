<!DOCTYPE HTML>
<html lang="en-US" manifest="./manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Manipulating data | Backbeam documentation</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="backbeam">
        <meta name="description" content="Welcome to the Backbeam *documentation*.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="./ios-authentication.html" />
        
        
        <link rel="prev" href="./ios-objects.html" />
        

        <meta property="og:title" content="Manipulating data | Backbeam documentation">
        <meta property="og:site_name" content="Backbeam documentation">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/backbeam">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="gitbook/style.css">
        


        
    <div class="book" data-github="backbeam/backbeam.github.io" data-level="2.2" data-basepath="." data-revision="1399664636889">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://backbeam.io/documentation" target="_blank" class="btn pull-left"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    
    
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/backbeam/backbeam.github.io/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/backbeam/backbeam.github.io/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="./" >Backbeam documentation</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        

        

        
        <li>
            <a href="https://github.com/backbeam/backbeam.github.io/edit/master/ios-data.md" target="blank">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="./"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="overview.html">
                
                <a href="./overview.html">
                    <i class="fa fa-check"></i> <b>1.</b> Overview
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="1.1" data-path="overview-features.html">
                            
                            <a href="./overview-features.html">
                                <i class="fa fa-check"></i> <b>1.1.</b> Features
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.2" data-path="overview-query-language.html">
                            
                            <a href="./overview-query-language.html">
                                <i class="fa fa-check"></i> <b>1.2.</b> Query language
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.3" data-path="overview-control-panel.html">
                            
                            <a href="./overview-control-panel.html">
                                <i class="fa fa-check"></i> <b>1.3.</b> Control panel
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.4" data-path="overview-business-logic.html">
                            
                            <a href="./overview-business-logic.html">
                                <i class="fa fa-check"></i> <b>1.4.</b> Where to write the business logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.5" data-path="overview-authentication.html">
                            
                            <a href="./overview-authentication.html">
                                <i class="fa fa-check"></i> <b>1.5.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.6" data-path="overview-push-notifications.html">
                            
                            <a href="./overview-push-notifications.html">
                                <i class="fa fa-check"></i> <b>1.6.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.7" data-path="overview-email-delivery.html">
                            
                            <a href="./overview-email-delivery.html">
                                <i class="fa fa-check"></i> <b>1.7.</b> Email templates and delivery
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.8" data-path="overview-realtime.html">
                            
                            <a href="./overview-realtime.html">
                                <i class="fa fa-check"></i> <b>1.8.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="2" data-path="ios-sdk.html">
                
                <a href="./ios-sdk.html">
                    <i class="fa fa-check"></i> <b>2.</b> iOS SDK
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="ios-objects.html">
                            
                            <a href="./ios-objects.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Objects and query results
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="ios-data.html">
                            
                            <a href="./ios-data.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Manipulating data
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="ios-authentication.html">
                            
                            <a href="./ios-authentication.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.4" data-path="ios-server-side-logic.html">
                            
                            <a href="./ios-server-side-logic.html">
                                <i class="fa fa-check"></i> <b>2.4.</b> Server side logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.5" data-path="ios-push-notifications.html">
                            
                            <a href="./ios-push-notifications.html">
                                <i class="fa fa-check"></i> <b>2.5.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.6" data-path="ios-realtime.html">
                            
                            <a href="./ios-realtime.html">
                                <i class="fa fa-check"></i> <b>2.6.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="3" data-path="android-sdk.html">
                
                <a href="./android-sdk.html">
                    <i class="fa fa-check"></i> <b>3.</b> Android SDK
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="android-objects.html">
                            
                            <a href="./android-objects.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> Objects and query results
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="android-data.html">
                            
                            <a href="./android-data.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Manipulating data
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="android-authentication.html">
                            
                            <a href="./android-authentication.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.4" data-path="android-server-side-logic.html">
                            
                            <a href="./android-server-side-logic.html">
                                <i class="fa fa-check"></i> <b>3.4.</b> Server side logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.5" data-path="android-push-notifications.html">
                            
                            <a href="./android-push-notifications.html">
                                <i class="fa fa-check"></i> <b>3.5.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.6" data-path="android-realtime.html">
                            
                            <a href="./android-realtime.html">
                                <i class="fa fa-check"></i> <b>3.6.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="4" data-path="javascript-sdk.html">
                
                <a href="./javascript-sdk.html">
                    <i class="fa fa-check"></i> <b>4.</b> JavaScript SDK
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="4.1" data-path="javascript-data.html">
                            
                            <a href="./javascript-data.html">
                                <i class="fa fa-check"></i> <b>4.1.</b> Manipulating data
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.2" data-path="javascript-authentication.html">
                            
                            <a href="./javascript-authentication.html">
                                <i class="fa fa-check"></i> <b>4.2.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.3" data-path="javascript-server-side-logic.html">
                            
                            <a href="./javascript-server-side-logic.html">
                                <i class="fa fa-check"></i> <b>4.3.</b> Server side logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.4" data-path="javascript-push-notifications.html">
                            
                            <a href="./javascript-push-notifications.html">
                                <i class="fa fa-check"></i> <b>4.4.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.5" data-path="javascript-realtime.html">
                            
                            <a href="./javascript-realtime.html">
                                <i class="fa fa-check"></i> <b>4.5.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="5" data-path="web-development.html">
                
                <a href="./web-development.html">
                    <i class="fa fa-check"></i> <b>5.</b> Web development
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="5.1" data-path="web-development-versioning.html">
                            
                            <a href="./web-development-versioning.html">
                                <i class="fa fa-check"></i> <b>5.1.</b> Versioning
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.2" data-path="web-development-controllers.html">
                            
                            <a href="./web-development-controllers.html">
                                <i class="fa fa-check"></i> <b>5.2.</b> Controllers
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.3" data-path="web-development-domains.html">
                            
                            <a href="./web-development-domains.html">
                                <i class="fa fa-check"></i> <b>5.3.</b> Subdomains and custom domain
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.4" data-path="web-development-views.html">
                            
                            <a href="./web-development-views.html">
                                <i class="fa fa-check"></i> <b>5.4.</b> Views (templates)
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.5" data-path="web-development-assets.html">
                            
                            <a href="./web-development-assets.html">
                                <i class="fa fa-check"></i> <b>5.5.</b> Assets
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="6" data-path="rest-api.html">
                
                <a href="./rest-api.html">
                    <i class="fa fa-check"></i> <b>6.</b> REST API
                </a>
                
                
            </li>
        

        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 33.333333333333336%;min-width: 30.555555555555557%;"></div>
    </div>
    <div class="chapters">
    
        <a href="./index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="./overview.html" title="Overview" class="chapter done new-chapter" data-progress="1" style="left: 2.7777777777777777%;"></a>
    
        <a href="./overview-features.html" title="Features" class="chapter done " data-progress="1.1" style="left: 5.555555555555555%;"></a>
    
        <a href="./overview-query-language.html" title="Query language" class="chapter done " data-progress="1.2" style="left: 8.333333333333334%;"></a>
    
        <a href="./overview-control-panel.html" title="Control panel" class="chapter done " data-progress="1.3" style="left: 11.11111111111111%;"></a>
    
        <a href="./overview-business-logic.html" title="Where to write the business logic" class="chapter done " data-progress="1.4" style="left: 13.88888888888889%;"></a>
    
        <a href="./overview-authentication.html" title="Users authentication" class="chapter done " data-progress="1.5" style="left: 16.666666666666668%;"></a>
    
        <a href="./overview-push-notifications.html" title="Push notifications" class="chapter done " data-progress="1.6" style="left: 19.444444444444443%;"></a>
    
        <a href="./overview-email-delivery.html" title="Email templates and delivery" class="chapter done " data-progress="1.7" style="left: 22.22222222222222%;"></a>
    
        <a href="./overview-realtime.html" title="Realtime" class="chapter done " data-progress="1.8" style="left: 25%;"></a>
    
        <a href="./ios-sdk.html" title="iOS SDK" class="chapter done new-chapter" data-progress="2" style="left: 27.77777777777778%;"></a>
    
        <a href="./ios-objects.html" title="Objects and query results" class="chapter done " data-progress="2.1" style="left: 30.555555555555557%;"></a>
    
        <a href="./ios-data.html" title="Manipulating data" class="chapter done " data-progress="2.2" style="left: 33.333333333333336%;"></a>
    
        <a href="./ios-authentication.html" title="Users authentication" class="chapter  " data-progress="2.3" style="left: 36.111111111111114%;"></a>
    
        <a href="./ios-server-side-logic.html" title="Server side logic" class="chapter  " data-progress="2.4" style="left: 38.888888888888886%;"></a>
    
        <a href="./ios-push-notifications.html" title="Push notifications" class="chapter  " data-progress="2.5" style="left: 41.666666666666664%;"></a>
    
        <a href="./ios-realtime.html" title="Realtime" class="chapter  " data-progress="2.6" style="left: 44.44444444444444%;"></a>
    
        <a href="./android-sdk.html" title="Android SDK" class="chapter  new-chapter" data-progress="3" style="left: 47.22222222222222%;"></a>
    
        <a href="./android-objects.html" title="Objects and query results" class="chapter  " data-progress="3.1" style="left: 50%;"></a>
    
        <a href="./android-data.html" title="Manipulating data" class="chapter  " data-progress="3.2" style="left: 52.77777777777778%;"></a>
    
        <a href="./android-authentication.html" title="Users authentication" class="chapter  " data-progress="3.3" style="left: 55.55555555555556%;"></a>
    
        <a href="./android-server-side-logic.html" title="Server side logic" class="chapter  " data-progress="3.4" style="left: 58.333333333333336%;"></a>
    
        <a href="./android-push-notifications.html" title="Push notifications" class="chapter  " data-progress="3.5" style="left: 61.111111111111114%;"></a>
    
        <a href="./android-realtime.html" title="Realtime" class="chapter  " data-progress="3.6" style="left: 63.888888888888886%;"></a>
    
        <a href="./javascript-sdk.html" title="JavaScript SDK" class="chapter  new-chapter" data-progress="4" style="left: 66.66666666666667%;"></a>
    
        <a href="./javascript-data.html" title="Manipulating data" class="chapter  " data-progress="4.1" style="left: 69.44444444444444%;"></a>
    
        <a href="./javascript-authentication.html" title="Users authentication" class="chapter  " data-progress="4.2" style="left: 72.22222222222223%;"></a>
    
        <a href="./javascript-server-side-logic.html" title="Server side logic" class="chapter  " data-progress="4.3" style="left: 75%;"></a>
    
        <a href="./javascript-push-notifications.html" title="Push notifications" class="chapter  " data-progress="4.4" style="left: 77.77777777777777%;"></a>
    
        <a href="./javascript-realtime.html" title="Realtime" class="chapter  " data-progress="4.5" style="left: 80.55555555555556%;"></a>
    
        <a href="./web-development.html" title="Web development" class="chapter  new-chapter" data-progress="5" style="left: 83.33333333333333%;"></a>
    
        <a href="./web-development-versioning.html" title="Versioning" class="chapter  " data-progress="5.1" style="left: 86.11111111111111%;"></a>
    
        <a href="./web-development-controllers.html" title="Controllers" class="chapter  " data-progress="5.2" style="left: 88.88888888888889%;"></a>
    
        <a href="./web-development-domains.html" title="Subdomains and custom domain" class="chapter  " data-progress="5.3" style="left: 91.66666666666667%;"></a>
    
        <a href="./web-development-views.html" title="Views (templates)" class="chapter  " data-progress="5.4" style="left: 94.44444444444444%;"></a>
    
        <a href="./web-development-assets.html" title="Assets" class="chapter  " data-progress="5.5" style="left: 97.22222222222223%;"></a>
    
        <a href="./rest-api.html" title="REST API" class="chapter  new-chapter" data-progress="6" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_10">
                    
                        <h1 id="manipulating-data">Manipulating data</h1>
<p>This documentation is about manipulating data from the iOS code. This means you are using client-side logic so it requires you to create a pair of API keys and configure them in your <code>AppDelegate</code>. If you want to use server-side logic you should go to the <a href="ios-server-side-logic.html">Server-side logic</a> section of the documentation.</p>
<h2 id="queries">Queries</h2>
<p>The most common thing you will want to do is making queries to the database from your code. This requires you to use <code>BBQuery</code> objects. You need to specify which entity you want to query and then most of the times you will specify the BQL query and parameters, optionally a fetch policy and finally you will fetch the data. Let&#39;s see an example:</p>
<pre><code class="lang-objectivec">BBQuery* query = [Backbeam queryForEntity:@<span class="hljs-string">"entity-name"</span>];
<span class="hljs-comment">// optional: use a BQL query for constraints</span>
[query setQuery:@<span class="hljs-string">"where ..."</span> withParams:[<span class="hljs-built_in">NSArray</span> ...]];
<span class="hljs-comment">// optional: you can set a fetch policy</span>
[query setFetchPolicy:BBFetchPolicyLocalAndRemote];
[query fetch:<span class="hljs-number">100</span> offset:<span class="hljs-number">0</span> success:^(<span class="hljs-built_in">NSArray</span>* objects, <span class="hljs-built_in">NSInteger</span> totalCount, <span class="hljs-built_in">BOOL</span> fromCache) {
  <span class="hljs-comment">// do something with these objects</span>
} failure:^(<span class="hljs-built_in">NSError</span>* error) {
  <span class="hljs-comment">// something went wrong</span>
}];
</code></pre>
<p>The fetch policy indicates if the local cache should be used and how. These are the the available values:</p>
<ul>
<li><code>BBFetchPolicyRemoteOnly</code>
This is the default. Data is only retrieved from the server</li>
<li><code>BBFetchPolicyLocalOnly</code>
Data is only retrieved from the local cache. If no data is available the failure block is called</li>
<li><code>BBFetchPolicyLocalAndRemote</code>
Data is retrieved first from the local cache. If there is data available the success block is called. Then data is fetched from the server, so the success can be called twice.</li>
<li><code>BBFetchPolicyLocalOrRemote</code>
If data is available in the local cache it is passed to the success block. If it isn&#39;t data is fetched from the server. No block is called twice in either case.</li>
<li><code>BBFetchRemoteAndStore</code>
Fetch the data from the server and then update the cache with that information. This is useful if you know that the cache information is not up to date and you want to fetch the latest information and then update the cache. For example after deleting or updating an object in a list and you want to refresh that list.</li>
</ul>
<h2 id="collection-constraints">Collection constraints</h2>
<p>There is a helper object to create collection constraints when using the <code>in</code> operator in a query.</p>
<pre><code class="lang-objectivec">BBCollectionConstraint *collection = [[BBCollectionConstraint alloc] init];
[collection addTwitterIdentifier:someTwitterIdentifier];
[collection addObject:[Backbeam emptyObjectForEntity:@<span class="hljs-string">"user"</span> withIdentifier:someBackbeamIdentifier]];
[collection addEmailAddress:@<span class="hljs-string">"user@example.com"</span>];

BBQuery *query = [Backbeam queryForEntity:@<span class="hljs-string">"user"</span>];
[query setQuery:@<span class="hljs-string">"where this in ?"</span> withParams:@[collection]];
[query fetch:<span class="hljs-number">100</span> offset:<span class="hljs-number">0</span> success:^(<span class="hljs-built_in">NSArray</span> *objects, <span class="hljs-built_in">NSInteger</span> total, <span class="hljs-built_in">BOOL</span> fromCache) {
    <span class="hljs-built_in">NSLog</span>(@<span class="hljs-string">"objects %d"</span>, objects<span class="hljs-variable">.count</span>);
} failure:^(<span class="hljs-built_in">NSError</span> *error) {
    <span class="hljs-built_in">NSLog</span>(@<span class="hljs-string">"error %@"</span>, error);
}];
</code></pre>
<p>As you can see in the collection constraint you can use Backbeam objects. This applies to any entity in your data model. If you are querying users you can also use Twitter, Facebook, Google+, LinkedIn or GitHub identifiers as well as email addresses.</p>
<h2 id="removing-objects-matching-a-query">Removing objects matching a query</h2>
<p>If you need to remove several objects at once and they share common constraints you can create a query and then call one of these two avaiable methods.</p>
<p>You can remove a limited number of objects:</p>
<pre><code class="lang-objectivec">BBQuery *query = [Backbeam queryForEntity:@<span class="hljs-string">"some-entity"</span>];
[query setQuery:@<span class="hljs-string">"where something &gt; ?"</span> withParams:@[ @<span class="hljs-number">100</span> ]]; <span class="hljs-comment">// some constraints</span>
[query removeObjects:<span class="hljs-number">10</span> offset:<span class="hljs-number">0</span> success:^(<span class="hljs-built_in">NSInteger</span> removed) { <span class="hljs-comment">// remove the first 10 objects that match the query</span>
    <span class="hljs-comment">// Here the objects has been removed and you can access the number of removed objects</span>
} failure:^(<span class="hljs-built_in">NSError</span> *error) {
    <span class="hljs-comment">// Something went wrong</span>
}];
</code></pre>
<p>Or you can remove all objects matching the query</p>
<pre><code class="lang-objectivec">BBQuery *query = [Backbeam queryForEntity:@<span class="hljs-string">"some-entity"</span>];
[query setQuery:@<span class="hljs-string">"where something &gt; ?"</span> withParams:@[ @<span class="hljs-number">100</span> ]]; <span class="hljs-comment">// some constraints</span>
[query removeAllObjects:^(<span class="hljs-built_in">NSInteger</span> removed) { <span class="hljs-comment">// remove all the objects matching this query</span>
    <span class="hljs-comment">// Here the objects has been removed and you can access the number of removed objects</span>
} failure:^(<span class="hljs-built_in">NSError</span> *error) {
    <span class="hljs-comment">// Something went wrong</span>
}];
</code></pre>
<h2 id="querying-and-refreshing-single-objects">Querying and refreshing single objects</h2>
<p>You can create empty objects of a certain entity by using these methods.</p>
<pre><code class="lang-objectivec">+ (BBObject*)emptyObjectForEntity:(<span class="hljs-built_in">NSString</span>*)entity;
+ (BBObject*)emptyObjectForEntity:(<span class="hljs-built_in">NSString</span>*)entity
           withIdentifier:(<span class="hljs-built_in">NSString</span>*)identifier; <span class="hljs-comment">// use this if you know the object id</span>
</code></pre>
<p>There are a couple of reasons to create empty objects. The first one is obvious: you want to create a new one. Once instantiated you will be able to save it as you will see below. The other reason is when you know the identifier of an object and you want to add it to a relationship for example, but you don&#39;t need the actual data: you just want to create the relationship between both objects. In this case it is enough to pass an empty object as long as it has the right entity and identifier.</p>
<p>If you have an object that comes from somewhere and at some point you want to refresh its values because it could be out of date and you need the most recent information you can use the <code>refresh</code> method. There are two versions of this method. The first one only requires a succcess and a failure block. In this case the object have all its regular fields refreshed. The second version also allows you to perform joins over the object. Example:</p>
<pre><code class="lang-objectivec">[object refresh:@<span class="hljs-string">"join something having foo &gt; ?"</span> params:@[param] success:^(BBObject *object) {
  <span class="hljs-comment">// do something on success</span>
} failure:^(BBObject *object, <span class="hljs-built_in">NSError</span> *err) {
  <span class="hljs-comment">// ops, something went wrong</span>
}];
</code></pre>
<p>You will only need the params argument if your BQL join needs params. Otherwise you can pass nil safely.</p>
<p>This second version of the refresh method will refresh all the regular fields and will refresh the relationships used in the BQL query as well.</p>
<h2 id="creating-and-updating-objects">Creating and updating objects</h2>
<p>To create or update objects just use the <code>save</code> method. Let&#39;s see how to create an object from scratch:</p>
<pre><code class="lang-objectivec">BBObject* object = [Backbeam emptyObjectForEntity:@<span class="hljs-string">"some_entity"</span>];
[object setString:@<span class="hljs-string">"field value"</span> forField:@<span class="hljs-string">"field-name"</span>];
[object save:^(BBObject* obj) {
  <span class="hljs-comment">// The object is saved! You can access its identifier if you need it</span>
  <span class="hljs-comment">// 'obj' and 'object' are the same object.</span>
  <span class="hljs-comment">// It is passed to the block just to simplify the code and prevent retain cycles</span>
} failure:^(BBObject* obj, <span class="hljs-built_in">NSError</span>* error) {
  <span class="hljs-comment">// Something went wrong</span>
}];
</code></pre>
<p>If you are updating an object and everything goes ok all fields are synchronized with the database, not just the fields you have changed. Let&#39;s see how it works:</p>
<pre><code class="lang-objectivec">BBObject* object = ...; <span class="hljs-comment">// some object already created</span>
[object setString:@<span class="hljs-string">"field value"</span> forField:@<span class="hljs-string">"field-name"</span>];
[object save:^(BBObject* obj) {
  <span class="hljs-comment">// If someone changed this object the 'object' variable is now up to date with all those changes</span>
  <span class="hljs-comment">// For example, if someone changed a field called 'whatever' you can access its value here</span>
  <span class="hljs-built_in">NSString</span>* value = [obj stringForField:@<span class="hljs-string">"whatever"</span>];
} failure:^(BBObject* obj, <span class="hljs-built_in">NSError</span>* error) {
  <span class="hljs-comment">// Something went wrong</span>
}];
</code></pre>
<p>You have many methods to set the values of the fields depending on its value type:</p>
<pre><code class="lang-objectivec"><span class="hljs-comment">// String fields</span>
- (<span class="hljs-built_in">BOOL</span>)setString:(<span class="hljs-built_in">NSString</span>*)obj forField:(<span class="hljs-built_in">NSString</span>*)key;

<span class="hljs-comment">// Number fields</span>
- (<span class="hljs-built_in">BOOL</span>)setNumber:(<span class="hljs-built_in">NSNumber</span>*)obj forField:(<span class="hljs-built_in">NSString</span>*)key;

- (<span class="hljs-keyword">void</span>)incrementField:(<span class="hljs-built_in">NSString</span>*)key by:(<span class="hljs-built_in">NSInteger</span>)value;

<span class="hljs-comment">// Location fields</span>
- (<span class="hljs-built_in">BOOL</span>)setLocation:(BBLocation*)obj forField:(<span class="hljs-built_in">NSString</span>*)key;

<span class="hljs-comment">// relationship "to-one"</span>
- (<span class="hljs-built_in">BOOL</span>)setObject:(BBObject*)obj forField:(<span class="hljs-built_in">NSString</span>*)key;

<span class="hljs-comment">// Date fields</span>
- (<span class="hljs-built_in">BOOL</span>)setDate:(<span class="hljs-built_in">NSDate</span>*)obj forField:(<span class="hljs-built_in">NSString</span>*)key;

<span class="hljs-comment">// Boolean fields</span>
- (<span class="hljs-built_in">BOOL</span>)setBoolean:(<span class="hljs-built_in">NSNumber</span>*)obj forField:(<span class="hljs-built_in">NSString</span>*)key;

<span class="hljs-comment">// Day fields</span>
- (<span class="hljs-built_in">BOOL</span>)setDay:(NSDateComponents*)obj forField:(<span class="hljs-built_in">NSString</span>*)key;

<span class="hljs-comment">// Helper method for day fields (uses the current calendar timezone)</span>
- (<span class="hljs-built_in">BOOL</span>)setDayFromDate:(<span class="hljs-built_in">NSDate</span>*)date forField:(<span class="hljs-built_in">NSString</span>*)key;

<span class="hljs-comment">// JSON fields</span>
- (<span class="hljs-built_in">BOOL</span>)setJSON:(<span class="hljs-keyword">id</span>)obj forField:(<span class="hljs-built_in">NSString</span>*)key;

<span class="hljs-comment">// For any field type</span>
- (<span class="hljs-built_in">BOOL</span>)setRawValue:(<span class="hljs-keyword">id</span>)obj forField:(<span class="hljs-built_in">NSString</span>*)key;
</code></pre>
<p>We have seen how to create and update objects using simple fields, but what about relationships? You can manage &quot;to-many&quot; relationships using the following methods:</p>
<pre><code class="lang-objectivec">BBObject* user = ...; <span class="hljs-comment">// some user</span>
[user addObject:otherUser forField:@<span class="hljs-string">"contacts"</span>]; <span class="hljs-comment">// add 'otherUser' to 'contacts' relationship</span>
[user removeObject:yetAnotherUser forField:@<span class="hljs-string">"contacts"</span>]; <span class="hljs-comment">// remove 'yetAnotherUser' from 'contacts' relationship</span>
[user save:^(BBObject* obj) {
  <span class="hljs-comment">// done!</span>
} failure:^(BBObject* obj, <span class="hljs-built_in">NSError</span>* error) {
  <span class="hljs-comment">// Something went wrong</span>
}];
</code></pre>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="./ios-objects.html" class="navigation navigation-prev "><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./ios-authentication.html" class="navigation navigation-next "><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="gitbook/app.js"></script>
        

    
    <script src="gitbook/plugins/gitbook-plugin-disqus/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":"sepia","family":"serif","size":1},"disqus":{"shortName":"backbeamdocs"}};
    gitbook.start(config);
});
</script>

    </body>
</html>
