<!DOCTYPE HTML>
<html lang="en-US" manifest="./manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Query language | Backbeam.io documentation</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="backbeam">
        <meta name="description" content="Welcome to the Backbeam documentation. This documentation describes the [Backbeam.io service](https://backbeam.io) and its SDKs.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="./overview-business-logic.html" />
        
        
        <link rel="prev" href="./overview.html" />
        

        <meta property="og:title" content="Query language | Backbeam.io documentation">
        <meta property="og:site_name" content="Backbeam.io documentation">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/backbeam">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="gitbook/style.css">
        


        
    <div class="book" data-github="backbeam/backbeam.github.io" data-level="1.1" data-basepath="." data-revision="1411501599402">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://backbeam.io/documentation" target="_blank" class="btn pull-left"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/backbeam/backbeam.github.io/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/backbeam/backbeam.github.io/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="./" >Backbeam.io documentation</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        

        

        
        <li>
            <a href="https://github.com/backbeam/backbeam.github.io/edit/master/overview-query-language.md" target="blank">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="./"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="overview.html">
                
                <a href="./overview.html">
                    <i class="fa fa-check"></i> <b>1.</b> Features
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="1.1" data-path="overview-query-language.html">
                            
                            <a href="./overview-query-language.html">
                                <i class="fa fa-check"></i> <b>1.1.</b> Query language
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.2" data-path="overview-business-logic.html">
                            
                            <a href="./overview-business-logic.html">
                                <i class="fa fa-check"></i> <b>1.2.</b> Where to write the business logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.3" data-path="overview-authentication.html">
                            
                            <a href="./overview-authentication.html">
                                <i class="fa fa-check"></i> <b>1.3.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.4" data-path="overview-push-notifications.html">
                            
                            <a href="./overview-push-notifications.html">
                                <i class="fa fa-check"></i> <b>1.4.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.5" data-path="overview-email-delivery.html">
                            
                            <a href="./overview-email-delivery.html">
                                <i class="fa fa-check"></i> <b>1.5.</b> Email templates and delivery
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.6" data-path="overview-realtime.html">
                            
                            <a href="./overview-realtime.html">
                                <i class="fa fa-check"></i> <b>1.6.</b> Realtime
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.7" data-path="overview-templating-engine.html">
                            
                            <a href="./overview-templating-engine.html">
                                <i class="fa fa-check"></i> <b>1.7.</b> Templating engine
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="2" data-path="ios-sdk.html">
                
                <a href="./ios-sdk.html">
                    <i class="fa fa-check"></i> <b>2.</b> iOS SDK
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="ios-objects.html">
                            
                            <a href="./ios-objects.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Objects and query results
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="ios-data.html">
                            
                            <a href="./ios-data.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Manipulating data
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="ios-authentication.html">
                            
                            <a href="./ios-authentication.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.4" data-path="ios-server-side-logic.html">
                            
                            <a href="./ios-server-side-logic.html">
                                <i class="fa fa-check"></i> <b>2.4.</b> Server side logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.5" data-path="ios-push-notifications.html">
                            
                            <a href="./ios-push-notifications.html">
                                <i class="fa fa-check"></i> <b>2.5.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.6" data-path="ios-realtime.html">
                            
                            <a href="./ios-realtime.html">
                                <i class="fa fa-check"></i> <b>2.6.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="3" data-path="android-sdk.html">
                
                <a href="./android-sdk.html">
                    <i class="fa fa-check"></i> <b>3.</b> Android SDK
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="android-objects.html">
                            
                            <a href="./android-objects.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> Objects and query results
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="android-data.html">
                            
                            <a href="./android-data.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Manipulating data
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="android-authentication.html">
                            
                            <a href="./android-authentication.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.4" data-path="android-server-side-logic.html">
                            
                            <a href="./android-server-side-logic.html">
                                <i class="fa fa-check"></i> <b>3.4.</b> Server side logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.5" data-path="android-push-notifications.html">
                            
                            <a href="./android-push-notifications.html">
                                <i class="fa fa-check"></i> <b>3.5.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.6" data-path="android-realtime.html">
                            
                            <a href="./android-realtime.html">
                                <i class="fa fa-check"></i> <b>3.6.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="4" data-path="javascript-sdk.html">
                
                <a href="./javascript-sdk.html">
                    <i class="fa fa-check"></i> <b>4.</b> JavaScript SDK
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="4.1" data-path="javascript-data.html">
                            
                            <a href="./javascript-data.html">
                                <i class="fa fa-check"></i> <b>4.1.</b> Manipulating data
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.2" data-path="javascript-authentication.html">
                            
                            <a href="./javascript-authentication.html">
                                <i class="fa fa-check"></i> <b>4.2.</b> Users authentication
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.3" data-path="javascript-server-side-logic.html">
                            
                            <a href="./javascript-server-side-logic.html">
                                <i class="fa fa-check"></i> <b>4.3.</b> Server side logic
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.4" data-path="javascript-push-notifications.html">
                            
                            <a href="./javascript-push-notifications.html">
                                <i class="fa fa-check"></i> <b>4.4.</b> Push notifications
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.5" data-path="javascript-realtime.html">
                            
                            <a href="./javascript-realtime.html">
                                <i class="fa fa-check"></i> <b>4.5.</b> Realtime
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="5" data-path="web-development.html">
                
                <a href="./web-development.html">
                    <i class="fa fa-check"></i> <b>5.</b> Web development
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="5.1" data-path="web-development-versioning.html">
                            
                            <a href="./web-development-versioning.html">
                                <i class="fa fa-check"></i> <b>5.1.</b> Versioning
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.2" data-path="web-development-controllers.html">
                            
                            <a href="./web-development-controllers.html">
                                <i class="fa fa-check"></i> <b>5.2.</b> Controllers
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.3" data-path="web-development-domains.html">
                            
                            <a href="./web-development-domains.html">
                                <i class="fa fa-check"></i> <b>5.3.</b> Subdomains and custom domain
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.4" data-path="web-development-views.html">
                            
                            <a href="./web-development-views.html">
                                <i class="fa fa-check"></i> <b>5.4.</b> Views (templates)
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.5" data-path="web-development-assets.html">
                            
                            <a href="./web-development-assets.html">
                                <i class="fa fa-check"></i> <b>5.5.</b> Assets
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="6" data-path="rest-api.html">
                
                <a href="./rest-api.html">
                    <i class="fa fa-check"></i> <b>6.</b> REST API
                </a>
                
                
            </li>
        

        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 5.714285714285714%;min-width: 2.857142857142857%;"></div>
    </div>
    <div class="chapters">
    
        <a href="./index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="./overview.html" title="Features" class="chapter done new-chapter" data-progress="1" style="left: 2.857142857142857%;"></a>
    
        <a href="./overview-query-language.html" title="Query language" class="chapter done " data-progress="1.1" style="left: 5.714285714285714%;"></a>
    
        <a href="./overview-business-logic.html" title="Where to write the business logic" class="chapter  " data-progress="1.2" style="left: 8.571428571428571%;"></a>
    
        <a href="./overview-authentication.html" title="Users authentication" class="chapter  " data-progress="1.3" style="left: 11.428571428571429%;"></a>
    
        <a href="./overview-push-notifications.html" title="Push notifications" class="chapter  " data-progress="1.4" style="left: 14.285714285714286%;"></a>
    
        <a href="./overview-email-delivery.html" title="Email templates and delivery" class="chapter  " data-progress="1.5" style="left: 17.142857142857142%;"></a>
    
        <a href="./overview-realtime.html" title="Realtime" class="chapter  " data-progress="1.6" style="left: 20%;"></a>
    
        <a href="./overview-templating-engine.html" title="Templating engine" class="chapter  " data-progress="1.7" style="left: 22.857142857142858%;"></a>
    
        <a href="./ios-sdk.html" title="iOS SDK" class="chapter  new-chapter" data-progress="2" style="left: 25.714285714285715%;"></a>
    
        <a href="./ios-objects.html" title="Objects and query results" class="chapter  " data-progress="2.1" style="left: 28.571428571428573%;"></a>
    
        <a href="./ios-data.html" title="Manipulating data" class="chapter  " data-progress="2.2" style="left: 31.428571428571427%;"></a>
    
        <a href="./ios-authentication.html" title="Users authentication" class="chapter  " data-progress="2.3" style="left: 34.285714285714285%;"></a>
    
        <a href="./ios-server-side-logic.html" title="Server side logic" class="chapter  " data-progress="2.4" style="left: 37.142857142857146%;"></a>
    
        <a href="./ios-push-notifications.html" title="Push notifications" class="chapter  " data-progress="2.5" style="left: 40%;"></a>
    
        <a href="./ios-realtime.html" title="Realtime" class="chapter  " data-progress="2.6" style="left: 42.857142857142854%;"></a>
    
        <a href="./android-sdk.html" title="Android SDK" class="chapter  new-chapter" data-progress="3" style="left: 45.714285714285715%;"></a>
    
        <a href="./android-objects.html" title="Objects and query results" class="chapter  " data-progress="3.1" style="left: 48.57142857142857%;"></a>
    
        <a href="./android-data.html" title="Manipulating data" class="chapter  " data-progress="3.2" style="left: 51.42857142857143%;"></a>
    
        <a href="./android-authentication.html" title="Users authentication" class="chapter  " data-progress="3.3" style="left: 54.285714285714285%;"></a>
    
        <a href="./android-server-side-logic.html" title="Server side logic" class="chapter  " data-progress="3.4" style="left: 57.142857142857146%;"></a>
    
        <a href="./android-push-notifications.html" title="Push notifications" class="chapter  " data-progress="3.5" style="left: 60%;"></a>
    
        <a href="./android-realtime.html" title="Realtime" class="chapter  " data-progress="3.6" style="left: 62.857142857142854%;"></a>
    
        <a href="./javascript-sdk.html" title="JavaScript SDK" class="chapter  new-chapter" data-progress="4" style="left: 65.71428571428571%;"></a>
    
        <a href="./javascript-data.html" title="Manipulating data" class="chapter  " data-progress="4.1" style="left: 68.57142857142857%;"></a>
    
        <a href="./javascript-authentication.html" title="Users authentication" class="chapter  " data-progress="4.2" style="left: 71.42857142857143%;"></a>
    
        <a href="./javascript-server-side-logic.html" title="Server side logic" class="chapter  " data-progress="4.3" style="left: 74.28571428571429%;"></a>
    
        <a href="./javascript-push-notifications.html" title="Push notifications" class="chapter  " data-progress="4.4" style="left: 77.14285714285714%;"></a>
    
        <a href="./javascript-realtime.html" title="Realtime" class="chapter  " data-progress="4.5" style="left: 80%;"></a>
    
        <a href="./web-development.html" title="Web development" class="chapter  new-chapter" data-progress="5" style="left: 82.85714285714286%;"></a>
    
        <a href="./web-development-versioning.html" title="Versioning" class="chapter  " data-progress="5.1" style="left: 85.71428571428571%;"></a>
    
        <a href="./web-development-controllers.html" title="Controllers" class="chapter  " data-progress="5.2" style="left: 88.57142857142857%;"></a>
    
        <a href="./web-development-domains.html" title="Subdomains and custom domain" class="chapter  " data-progress="5.3" style="left: 91.42857142857143%;"></a>
    
        <a href="./web-development-views.html" title="Views (templates)" class="chapter  " data-progress="5.4" style="left: 94.28571428571429%;"></a>
    
        <a href="./web-development-assets.html" title="Assets" class="chapter  " data-progress="5.5" style="left: 97.14285714285714%;"></a>
    
        <a href="./rest-api.html" title="REST API" class="chapter  new-chapter" data-progress="6" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_26">
                    
                        <h1 id="query-language">Query language</h1>
<p>The Backbeam Query Language is the way you will make queries to the data stored in your database. It is a language similar to SQL but much simpler and with the ability to describe complex queries easily.</p>
<h2 id="overview">Overview</h2>
<p>First of all BQL is just for querying. You cannot modifiy the database structure or insert, delete or update information using BQL. With BQL you just query (read) data</p>
<p>Another difference with SQL is that you don&#39;t need to specify a &quot;SELECT&quot; or a &quot;FROM&quot; like in SQL. You define the entity to which you are querying in other ways. For example in JavaScript you do</p>
<pre><code class="lang-sql">backbeam.<span class="hljs-operator"><span class="hljs-keyword">select</span>(entity).query(your-bql-goes-here)</span>
</code></pre>
<p>If you see a &quot;select&quot; somewhere in the documentation it is just to clarify an example but it is not a valid BQL query.</p>
<p>This is the general structure of a BQL query</p>
<pre><code class="lang-sql">[where &lt;constraints&gt;] [&lt;joins&gt;] [sort by &lt;sort-field&gt;]
</code></pre>
<p>And this is an example of query with a few options</p>
<pre><code class="lang-sql">[<span class="hljs-operator"><span class="hljs-keyword">select</span> news] <span class="hljs-keyword">where</span> title <span class="hljs-keyword">like</span> ? <span class="hljs-keyword">join</span> <span class="hljs-keyword">last</span> <span class="hljs-number">5</span> comments <span class="hljs-keyword">having</span> score &gt; <span class="hljs-number">10</span> <span class="hljs-keyword">fetch</span> author sort <span class="hljs-keyword">by</span> created_at</span>
</code></pre>
<h2 id="constraints">Constraints</h2>
<p>You can define multiple constraints in your BQL queries. You use the and and or operators and you can use parenthesis to group constraints. It is not recommended to use and and or in the same group, so better use parenthesis. It is not recommended because the precedence order is from right to left. For example in this query it is first calculated the or between the last two constraints and the result is applied to the and operator with the first constraint.</p>
<pre><code class="lang-sql">where &lt;constraint1&gt; and &lt;constraint2&gt; or &lt;constraint3&gt;
</code></pre>
<p>You can rewrite this query using parenthesis to change the precedence order</p>
<pre><code class="lang-sql">where (&lt;constraint1&gt; and &lt;constraint2&gt;) or &lt;constraint3&gt;
</code></pre>
<p>Constraints are usually composed by the name of a field followed by an operator and finish in the ? character. The ? acts as a placeholder character. This is done to prevent query injections. You pass the query parameters usually as extra arguments in the methods of the SDK you are using.</p>
<h2 id="fields-and-relationships">Fields and relationships</h2>
<p>You define the fields and relationships of your entities in the control panel of your project. You assign them a name and Bacbkeam automatically creates an identifier from that name by stripping some characters and replacing white spaces with dashes. For example you can create a field named &quot;Last event&quot; and Backbeam will give it the &quot;last-event&quot; identifier. The name is used in the control panel and you use the identifier in the API, SDKs and BQL queries. The same applies to entity names. Each entity has a name and Backbeam creates an identifier from that name. So you can have an entity named &quot;Points of interest&quot; and Backbeam will give it the identifier &quot;points-of-interest&quot;.</p>
<p>There are two predefined entities (User and File) and each entity has also some predefined fields including (&#39;created_at&#39; and &#39;updated_at&#39;) that you can use in BQL queries.</p>
<h2 id="operators">Operators</h2>
<p>There are many operators available: <code>=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>is</code>, <code>has</code>, <code>in</code>, <code>like</code></p>
<ul>
<li>The <code>=</code> operator can be used for numbers, strings and dates</li>
<li>The inequallity operators (<code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>) can be used for fields containing numbers and dates</li>
<li>The <code>like</code> operator can be used for fields containing strings (no matter if it is defined as text, textarea or richtextarea). This operator performs a full-text search. This behaviour differs from the <code>LIKE</code> operator in SQL</li>
<li>The <code>is</code> operator is used in relationships &quot;to-one&quot;</li>
<li>The <code>in</code> and has operators are used to define query constraints between &quot;to-many&quot; relationships</li>
</ul>
<h2 id="full-text-searches">Full-text searches</h2>
<p>You can perform full-text searches in fields storing text (even fields defined as richtext) using the like operator. Note that this operator behaves different from the LIKE operator in SQL. It is more similar to the <code>MATCH - AGAINST</code> operator of MySQL</p>
<pre><code class="lang-javascript">backbeam.select(entity).query(<span class="hljs-string">'where title like ?'</span>, <span class="hljs-string">'text to search'</span>)
</code></pre>
<p>Backbeam automatically searches objects with those words (one or more) and the results are sorted by default by relevance (bigger density of those words in the text). Backbeam ignores some stop-words. It first tries to detect in which language the text is written and then removes the stop-words of that language. Languages such as Chinese, Japanese, and Korean are not well indexed because these languages don&#39;t have separation between words.</p>
<h2 id="constraints-over-objects">Constraints over objects</h2>
<p>You can perform basic constraints over &quot;to-one&quot; relationships using the is operator</p>
<pre><code class="lang-javascript">backbeam.select(<span class="hljs-string">'places'</span>).query(<span class="hljs-string">'where city is ?'</span>, someCity)
</code></pre>
<p>This query searches places whose city is the given city as parameter.</p>
<p>You can also perform queries over the &quot;to-many&quot; part of your relationships using the in and has operators.</p>
<p>For example, having a database with langauges and countries with a &quot;many-to-many&quot; relationship (each country has many languages and each language is spoken in many contries) you can do:</p>
<pre><code class="lang-javascript">backbeam.select(<span class="hljs-string">'countries'</span>).query(<span class="hljs-string">'where languages has ?'</span>, someLanguage)
</code></pre>
<p>This searches those countries having someLanguage in its &quot;languages&quot; relationship. Finally the use of in is similar. Suppose a database with cities and users with favoriteCities.</p>
<pre><code class="lang-javascript">backbeam.select(<span class="hljs-string">'cities'</span>).query(<span class="hljs-string">'where this in ?.favoriteCities'</span>, someUser)
</code></pre>
<p>This query searches cities in the &quot;favoriteCities&quot; of a given user. The in operator is the only operator different in their structure. The this keyword is mandatory and in the right side of the operator you define the name of an external relationships (in this case a relationship in the &#39;user&#39; entity).</p>
<p>The in operator also supports a negative form: the not in operator. Additionally this operator supports &#39;collection constraints&#39;. Learn more about <a href="https://backbeam.io/article/introducing-collection-constraints-and-social-queries" target="_blank">collection constraints and social queries</a></p>
<h2 id="performing-joins">Performing joins</h2>
<p>You can perform a join over a &quot;to-one&quot; part of a relationship very easily. For example:</p>
<pre><code class="lang-javascript">backbeam.select(<span class="hljs-string">'cities'</span>).query(<span class="hljs-string">'join country'</span>)
</code></pre>
<p>You can also perform joins over any &quot;to-many&quot; side of a relationship. In these joins you usually define a number of results and a sort order with <code>first</code>/<code>last</code> that refers to the date in wich the object was added to the relationship. Some examples:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// The number of cities in the relationship is returned.</span>
<span class="hljs-comment">// It only returns the counter.</span>
<span class="hljs-comment">// It doesn't return any object</span>
backbeam.select(<span class="hljs-string">'country'</span>).query(<span class="hljs-string">'join cities'</span>)

<span class="hljs-comment">// Returns the 5 last cities added to the relationship</span>
backbeam.select(<span class="hljs-string">'country'</span>).query(<span class="hljs-string">'join last 5 cities'</span>)

<span class="hljs-comment">// Returns the 5 first cities added to the relationship</span>
backbeam.select(<span class="hljs-string">'country'</span>).query(<span class="hljs-string">'join first 5 cities'</span>)
</code></pre>
<p>If you don&#39;t specify a number of elements to join then no results are returned. But this could be useful because additionally you always get a number with the total number of objects in the relationship.</p>
<p>Additionally you can also specify constraints to the joins with the having keyword. For example</p>
<pre><code class="lang-javascript">backbeam.select(<span class="hljs-string">'news'</span>).query(<span class="hljs-string">'join last 5 comments having score &gt; ?'</span>, someMinimumScore)
</code></pre>
<p>Finally you can perform joins with fetch. In the example above you could be interested not only in the comments but also in the author of the joined comments. It is possible and easy to do, just include one fetch</p>
<pre><code class="lang-javascript">backbeam.select(<span class="hljs-string">'news'</span>).query(<span class="hljs-string">'join last 5 comments having score &gt; ? fetch author'</span>, someMinimumScore)
</code></pre>
<p>You can use several <code>fetch</code> in the same <code>join</code> separating them by commas.</p>
<h2 id="sorting-the-results">Sorting the results</h2>
<p>You can specify a sort order in your BQL queries. This is very simple.</p>
<pre><code class="lang-javascript">backbeam.select(<span class="hljs-string">'cities'</span>).query(<span class="hljs-string">'join country sort by name asc'</span>)
</code></pre>
<p>You can specify a sort order, either &#39;asc&#39; or &#39;desc&#39; and it&#39;s &#39;desc&#39; by default. If you don&#39;t specify a sort field the default is usually &#39;created_at&#39;. However the default sorting could change in some circumstances. For example if you don&#39;t specify a sort field and you are making a &#39;like&#39; constraint then de default sorting is by the relevance of the search results by that criteria. Geolocalizated queries also are sorted by distance by default.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="./overview.html" class="navigation navigation-prev "><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./overview-business-logic.html" class="navigation navigation-next "><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="gitbook/app.js"></script>
        

    
    <script src="gitbook/plugins/gitbook-plugin-disqus/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":"sepia","family":"serif","size":1},"disqus":{"shortName":"backbeamdocs"}};
    gitbook.start(config);
});
</script>

    </body>
</html>
